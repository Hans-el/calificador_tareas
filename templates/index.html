{% extends "base.html" %} {% block title %}Evaluador — Inicio{% endblock %} {%
block content %}

<div class="card shadow p-4 mx-auto" style="max-width: 700px">
  <h3 class="text-center mb-4">Evaluación Automática de Resúmenes</h3>

  <form
    id="form-evaluacion"
    action="/procesar"
    method="POST"
    enctype="multipart/form-data"
  >
    <!-- ================================ -->
    <!-- SUBIR ARCHIVO -->
    <!-- ================================ -->
    <div class="mb-3">
      <label class="form-label fw-bold">Seleccione un archivo</label>
      <input
        type="file"
        class="form-control"
        name="archivo"
        accept=".xlsx,.pdf,.docx"
        required
      />
      <small class="text-muted">Formatos aceptados: Excel, PDF y Word</small>
    </div>

    <hr />

    <!-- ================================ -->
    <!-- CRITERIOS -->
    <!-- ================================ -->
    <label class="fw-bold mb-2">Criterios de Evaluación</label>

    <div id="contenedor-criterios"></div>

    <button
      type="button"
      class="btn btn-warning mt-2 fw-semibold"
      onclick="agregarCriterio()"
    >
      Agregar criterio
    </button>

    <hr />

    <button class="btn btn-success w-100 mt-3 fw-bold" type="submit">
      Evaluar Documento
    </button>
  </form>
</div>

<script>
  // Lista de criterios predefinidos
  const criteriosDisponibles = [
    "Coherencia",
    "Claridad",
    "Ortografía",
    "Precisión",
    "Síntesis",
    "Relevancia",
    "Estructura",
    "Comprensión",
  ];

  // =====================================
  // Crear un bloque de criterio
  // =====================================
  function agregarCriterio() {
    const cont = document.getElementById("contenedor-criterios");

    let div = document.createElement("div");
    div.classList = "row mb-2 criterio-item";

    div.innerHTML = `
      <div class="col-7">
        <select name="criterio_nombre" class="form-select" required>
          ${criteriosDisponibles
            .map((c) => `<option value="${c}">${c}</option>`)
            .join("")}
        </select>
      </div>

      <div class="col-4">
        <input type="number" class="form-control" name="criterio_peso"
               placeholder="Nota (1-9)" min="1" max="9" required>
      </div>

      <div class="col-1 text-center">
        <button type="button"
                class="btn btn-danger btn-sm"
                onclick="this.parentNode.parentNode.remove();">
          X
        </button>
      </div>
    `;

    cont.appendChild(div);
  }

  // =====================================
  // Agregar un criterio al cargar la página
  // =====================================
  document.addEventListener("DOMContentLoaded", () => agregarCriterio());
</script>

{% endblock %}
