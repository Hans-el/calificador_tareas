{% extends "base.html" %} {% block title %}Evaluador — Resultados{% endblock %}
{% block content %}
<div class="card shadow p-4 mx-auto" style="max-width: 800px">
  <h3 class="text-center mb-4">Resultados de la Evaluación</h3>

  {% if error %}
  <div class="alert alert-danger">{{ error }}</div>
  {% else %} {% if archivo_generado %}
  <div class="alert alert-success mb-4">
    <p class="mb-0">La evaluación se completó con éxito.</p>
  </div>
  <div class="d-grid gap-2 mb-4">
    <a
      href="{{ url_for('descargar', archivo=archivo_generado) }}"
      class="btn btn-primary"
    >
      Descargar Rúbrica en Excel
    </a>
  </div>
  {% endif %} {% if resultado %}
  <div class="table-responsive">
    <h5 class="mb-3">Detalles de la Evaluación:</h5>
    <table class="table table-bordered table-striped">
      <thead class="table-dark">
        <tr>
          <th>Tarea</th>
          <th>Calificación Final</th>
          {% for criterio in resultado[0]['criterios'] %}
          <th>{{ criterio['nombre'] }} (Puntaje)</th>
          <th>{{ criterio['nombre'] }} (Justificación)</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for fila in resultado %}
        <tr>
          <td>{{ fila['Tarea'] }}</td>
          <td>{{ fila['Calificación Final'] }}</td>
          {% for criterio in fila['criterios'] %}
          <td>{{ criterio['puntaje'] }}</td>
          <td>{{ criterio['justificacion'] }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% endif %} {% endif %}
</div>
{% endblock %}
